<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Language" content="en" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>
    Dashboard 
    </title>
    

    <!-- loo -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <!-- <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-KyZXEAg3QhqLMpG8r+Knujsl5+z8NHIe0sIhV5P1wx9KlTAy0GfF1H3nY8fsB1Q6"
      crossorigin="anonymous"
    ></script> -->
   
  
    <!-- <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"
    /> -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css"
    />
      <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
      />
  
    <link
      href="https://demo.dashboardpack.com/architectui-html-free/main.css"
      rel="stylesheet"
    />
   

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <script src="/javascript/dashboardAjax.js"></script>
    <!-- loo -->
    <!-- <link
      href="https://demo.dashboardpack.com/architectui-html-free/main.css"
      rel="stylesheet"
    /> -->
  </head>
  <body>
    <!-- kokoko -->
    
    <!-- <style>
  @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap");:root{--header-height: 3rem;--first-color: #4723D9;--first-color-light: #AFA5D9;--white-color: #F7F6FB;--body-font: 'Nunito', sans-serif;--normal-font-size: 1rem;--z-fixed: 100}*,::before,::after{box-sizing: border-box}body{position: relative;margin: var(--header-height) 0 0 0;padding: 0 1rem;font-family: var(--body-font);font-size: var(--normal-font-size);transition: .5s}a{text-decoration: none}.header{width: 100%;height: var(--header-height);position: fixed;top: 0;left: 0;display: flex;align-items: center;justify-content: space-between;padding: 0 1rem;background-color: var(--white-color);z-index: var(--z-fixed);transition: .5s}.header_toggle{color: var(--first-color);font-size: 1.5rem;cursor: pointer}.header_img{width: 35px;height: 35px;display: flex;justify-content: center;border-radius: 50%;overflow: hidden}.header_img img{width: 40px}.l-navbar{position: fixed;top: 0;left: -30%;width: var(--nav-width);height: 100vh;background-color: var(--first-color);padding: .5rem 1rem 0 0;transition: .5s;z-index: var(--z-fixed)}.nav{height: 100%;display: flex;flex-direction: column;justify-content: space-between;overflow: hidden}.nav_logo, .nav_link{display: grid;grid-template-columns: max-content max-content;align-items: center;column-gap: 1rem;padding: .5rem 0 .5rem 1.5rem}.nav_logo{margin-bottom: 2rem}.nav_logo-icon{font-size: 1.25rem;color: var(--white-color)}.nav_logo-name{color: var(--white-color);font-weight: 700}.nav_link{position: relative;color: var(--first-color-light);margin-bottom: 1.5rem;transition: .3s}.nav_link:hover{color: var(--white-color)}.nav_icon{font-size: 1.25rem}.show{left: 0}.body-pd{padding-left: calc(var(--nav-width) + 1rem)}.active{color: var(--white-color)}.active::before{content: '';position: absolute;left: 0;width: 2px;height: 32px;background-color: var(--white-color)}.height-100{height:100vh}@media screen and (min-width: 768px){body{margin: calc(var(--header-height) + 1rem) 0 0 0;padding-left: calc(var(--nav-width) + 2rem)}.header{height: calc(var(--header-height) + 1rem);padding: 0 2rem 0 calc(var(--nav-width) + 2rem)}.header_img{width: 40px;height: 40px}.header_img img{width: 45px}.l-navbar{left: 0;padding: 1rem 1rem 0 0}.show{width: calc(var(--nav-width) + 156px)}.body-pd{padding-left: calc(var(--nav-width) + 188px)}} </style>
</style> -->
 <style>
        @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap");


      




      :root {
         --header-height: 3rem;
         --nav-width: 68px;
         --first-color: #4723D9;
         --first-color-light: #AFA5D9;
         --white-color: #F7F6FB;
         --body-font: 'Nunito', sans-serif;
         --normal-font-size: 1rem;
         --z-fixed: 100
      }

      *,
      ::before,
      ::after {
         box-sizing: border-box
      }

      body {
         position: relative;
         margin: var(--header-height) 0 0 0;
         padding: 0 1rem;
         font-family: var(--body-font);
         font-size: var(--normal-font-size);
         transition: .5s
      }

      a {
         text-decoration: none
      }

      .header {
         width: 100%;
         height: var(--header-height);
         position: fixed;
         top: 0;
         left: 0;
         display: flex;
         align-items: center;
         justify-content: space-between;
         padding: 0 1rem;
         background-color: var(--white-color);
         z-index: var(--z-fixed);
         transition: .5s
      }

      .header_toggle {
         color: var(--first-color);
         font-size: 1.5rem;
         cursor: pointer
      }

      

      .header_img img {
         width: 40px
      }

      .l-navbar {
         position: fixed;
         top: 0;
         left: -30%;
         width: var(--nav-width);
         height: 100vh;
         background-color: var(--first-color);
         padding: .5rem 1rem 0 0;
         transition: .5s;
         z-index: var(--z-fixed)
      }

      .nav {
         height: 100%;
         display: flex;
         flex-direction: column;
         justify-content: space-between;
         overflow: hidden
      }

      .nav_logo,
      .nav_link {
         display: grid;
         grid-template-columns: max-content max-content;
         align-items: center;
         column-gap: 1rem;
         padding: .5rem 0 .5rem 1.5rem
      }

      .nav_logo {
         margin-bottom: 2rem
      }

      .nav_logo-icon {
         font-size: 1.25rem;
         color: var(--white-color)
      }

      .nav_logo-name {
         color: var(--white-color);
         font-weight: 700
      }

      .nav_link {
         position: relative;
         color: var(--first-color-light);
         margin-bottom: 1.5rem;
         transition: .3s
      }

      .nav_link:hover {
         color: var(--white-color)
      }

      .nav_icon {
         font-size: 1.25rem
      }

      .show {
         left: 0
      }

      .body-pd {
         padding-left: calc(var(--nav-width) + 1rem)
      }

      .active {
         color: var(--white-color)
      }

      .active::before {
         content: '';
         position: absolute;
         left: 0;
         width: 2px;
         height: 32px;
         background-color: var(--white-color)
      }

      .height-100 {
         height: 100vh
      }

      @media screen and (min-width: 768px) {
         body {
            margin: calc(var(--header-height) + 1rem) 0 0 0;
            padding-left: calc(var(--nav-width) + 2rem)
         }

         .header {
            height: calc(var(--header-height) + 1rem);
            padding: 0 2rem 0 calc(var(--nav-width) + 2rem)
         }

         .header_img {
            width: 40px;
            height: 40px
         }

         .header_img img {
            width: 45px
         }

         .l-navbar {
            left: 0;
            padding: 1rem 1rem 0 0
         }

         .show1 {
            width: calc(var(--nav-width) + 156px)
         }

         .body-pd {
            padding-left: calc(var(--nav-width) + 188px)
         }
        }
        
</style>
</head>

    <body id="body-pd">

        <header class="header" id="header">
            <div class="header_toggle"> <i class='bx bx-menu' id="header-toggle"></i> </div>
            <div class="header_img"> <img src="/assets/IMG_6989-02.jpg" alt=""> </div>
        </header>
        <!-- https://i.imgur.com/hczKIze.jpg -->
        <div class="l-navbar" id="nav-bar">
            <nav class="nav">
              
                <div> <a href="#" class="nav_logo"> <i class='bx bx-layer nav_logo-icon'></i> <span class="nav_logo-name">TREND-VISTA</span> </a>
                    <div class="nav_list"> <a href="#" class="nav_link active"> <i class='bx bx-grid-alt nav_icon'></i> <span class="nav_name">Dashboard</span> </a> <a href="/admin/product" class="nav_link ">   <i class="fa-solid fa-bag-shopping" style="color: #ffffff;"></i> <span class="nav_name">Product</span> </a> <a href="/admin/catagory" class="nav_link"> <i class="fa-solid fa-list" style="color: #ffffff;"></i> <span class="nav_name">Catagories</span> </a> <a href="#" class="nav_link"> <i class="fa-solid fa-indian-rupee-sign" style="color: #ffffff;"></i> <span class="nav_name">Payments</span> </a> <a href="/admin/userlist" class="nav_link"> <i class="fa-regular fa-user" style="color: #ffffff;"></i> <span class="nav_name">Customers</span> </a> <a href="/admin/GetOrderinadmin" class="nav_link"> <i class="fa-solid fa-truck-fast" style="color: #ffffff;"></i> <span class="nav_name">Orders</span> </a> <a href="/admin/CouponAdmin" class="nav_link"> <i class="fa-solid fa-ticket" style="color: #ffffff;"></i> <span class="nav_name">Coupon</span> </a> <a href="/admin/BannerUI" class="nav_link"> <i class="fa-brands fa-slack" style="color: #ffffff;"></i>  <span class="nav_name">Banner</span> </a> </div>
                </div> <a href="/admin/signout" class="nav_link"> <i class='bx bx-log-out nav_icon'></i> <span class="nav_name">SignOut</span> </a>
            </nav>
        </div>
      
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <form id="salesreport" action="/Admin/Salesreport" method="post">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">New message</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Strat-Datae:</label>
            <input type="date" class="form-control" id="StartDate" name="StartDate" oninput="Formvalid()">
            <small class="text-danger" id="StartError"></small>
          </div>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">End-Date:</label>
            <input type="date" class="form-control" id="EndDate" name="EndDate" oninput="Formvalid()">
            <small class="text-danger" id="EndError"></small>
          </div>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Download Format</label>
            <select name="downloadFormat" class="form-select" id="downloadFormat" oninput="Formvalid()">
              <option value="">Select Format</option>
              <option value="pdf">Pdf</option>
              <!-- <option value="Excel">Excel</option> -->

            </select>
            <small class="text-danger" id="DownloadFormatError"></small>

          </div>
          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary" id="Downnload" disabled>Download</button>
        </div>
      </form>
    </div>
  </div>
</div>
        
    <div
      class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header"
    >
      <div class="app-main">
          <div class="app-main__inner">
            <div class="app-page-title">
              <div class="page-title-wrapper">
                <div class="page-title-heading">
                  <div class="page-title-icon">
                    <i class="pe-7s-car icon-gradient bg-mean-fruit"> </i>
                  </div>
                  <div>
                    Analytics Dashboard
                    <div class="page-title-subheading">
                     
                    </div>
                  </div>
                </div>
                <div class="page-title-actions">
                  <button
                    type="button"
                    data-toggle="tooltip"
                    title="Example Tooltip"
                    data-placement="bottom"
                    class="btn-shadow mr-3 btn btn-dark"
                  >
                    <i class="fa fa-star"></i>
                  </button>
                  <div class="d-inline-block dropdown">
                    <button
                      type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo"
                    >
                      <span class="btn-icon-wrapper pr-2 opacity-7">
                        <i class="fa fa-business-time fa-w-20"></i>
                      </span>
                  Sales Report
                    </button>
                       <div
                      tabindex="-1"
                      role="menu"
                      aria-hidden="true"
                      class="dropdown-menu dropdown-menu-right"
                    >
                      <ul class="nav flex-column">
                        <li class="nav-item">
                          <a href="javascript:void(0);" class="nav-link">
                            <i class="nav-link-icon lnr-inbox"></i>
                            <span> Inbox </span>
                            <div
                              class="ml-auto badge badge-pill badge-secondary"
                            >
                              86
                            </div>
                          </a>
                        </li>
                        <li class="nav-item">
                          <a href="javascript:void(0);" class="nav-link">
                            <i class="nav-link-icon lnr-book"></i>
                            <span> Book </span>
                            <div class="ml-auto badge badge-pill badge-danger">
                              5
                            </div>
                          </a>
                        </li>
                        <li class="nav-item">
                          <a href="javascript:void(0);" class="nav-link">
                            <i class="nav-link-icon lnr-picture"></i>
                            <span> Picture </span>
                          </a>
                        </li>
                        <li class="nav-item">
                          <a
                            disabled
                            href="javascript:void(0);"
                            class="nav-link disabled"
                          >
                            <i class="nav-link-icon lnr-file-empty"></i>
                            <span> File Disabled </span>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 col-xl-4">
                <div class="card mb-3 widget-content bg-midnight-bloom">
                  <div class="widget-content-wrapper text-white">
                    <div class="widget-content-left">
                      <div class="widget-heading">Total Orders</div>
                      <div class="widget-subheading">Last year expenses</div>
                    </div>
                    <div class="widget-content-right">
                      <div class="widget-numbers text-white">
                        <span>1896</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-xl-4">
                <div class="card mb-3 widget-content bg-arielle-smile">
                  <div class="widget-content-wrapper text-white">
                    <div class="widget-content-left">
                      <div class="widget-heading">Clients</div>
                      <div class="widget-subheading">Total Clients Profit</div>
                    </div>
                    <div class="widget-content-right">
                      <div class="widget-numbers text-white">
                        <span>$ 568</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-xl-4">
                <div class="card mb-3 widget-content bg-grow-early">
                  <div class="widget-content-wrapper text-white">
                    <div class="widget-content-left">
                      <div class="widget-heading">Followers</div>
                      <div class="widget-subheading">People Interested</div>
                    </div>
                    <div class="widget-content-right">
                      <div class="widget-numbers text-white">
                        <span>46%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-xl-none d-lg-block col-md-6 col-xl-4">
                <div class="card mb-3 widget-content bg-premium-dark">
                  <div class="widget-content-wrapper text-white">
                    <div class="widget-content-left">
                      <div class="widget-heading">Products Sold</div>
                      <div class="widget-subheading">Revenue streams</div>
                    </div>
                    <div class="widget-content-right">
                      <div class="widget-numbers text-warning">
                        <span>$14M</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12 col-lg-12">
                <div class="mb-3 card">
                  <div
                    class="card-header-tab card-header-tab-animation card-header"
                  >
                    <div class="card-header-title">
                      <i
                        class="header-icon lnr-apartment icon-gradient bg-love-kiss"
                      >
                      </i>
                      Sales Report ( Sales/Order )
                    </div>
                    <ul class="nav">
                      <li class="nav-item">
                        <a href="javascript:void(0);" class="active nav-link"  onclick="updatecount('/admin/count-orders-by-day')"
                          >Day</a
                        >
                      </li>
                      <li class="nav-item">
                        <a
                          href="javascript:void(0);"
                          class="nav-link second-tab-toggle"
                           onclick="updatecount('/admin/count-orders-by-month')"
                          >Month</a
                        >
                      </li>
                      <li class="nav-item" >
                        <a
                          href="javascript:void(0);"
                          class="nav-link second-tab-toggle"
                           onclick="updatecount('/admin/count-orders-by-year')" 
                          >Year</a
                        >
                      </li>
                    </ul>
                  </div>
                  <div class="card-body">
                    <div class="tab-content">
                      <div class="tab-pane fade show active" id="tabs-eg-77">
                        <div
                          class="card mb-3 widget-chart widget-chart2 text-left w-100"
                        >
                          <div class="widget-chat-wrapper-outer">
                            <div
                              class="widget-chart-wrapper widget-chart-wrapper-lg opacity-10 m-0"
                            >
                        <canvas id="reportsChart" height="100" ></canvas>
                            </div>
                          </div>
                        </div>
                        
                    </div>
                  </div>
                </div>
              </div>
              </div>
             <div class="row">
  <div class="col-md-12 col-lg-6">
    <div class="mb-3 card">
      <div class="card-header-tab card-header">
        <div class="card-header-title">
          <i class="header-icon lnr-rocket icon-gradient bg-tempting-azure"></i>
          Bar Chart (Sales/Order)
        </div>
        <ul class="nav">
          <li class="nav-item">
            <a href="javascript:void(0);" class="active nav-link" onclick="updatecount('/admin/count-orders-by-day')">Day</a>
          </li>
          <li class="nav-item">
            <a href="javascript:void(0);" class="nav-link second-tab-toggle" onclick="updatecount('/admin/count-orders-by-month')">Month</a>
          </li>
          <li class="nav-item">
            <a href="javascript:void(0);" class="nav-link second-tab-toggle" onclick="updatecount('/admin/count-orders-by-year')">Year</a>
          </li>
        </ul>
      </div>
      <div class="tab-content">
        <div class="tab-pane fade active show" id="tab-eg-55">
          <div class="widget-chart p-3">
            <div style="height: 350px">
              <canvas id="barChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-12 col-lg-6">
    <div class="mb-3 card">
      <div class="card-header-tab card-header">
        <div class="card-header-title">
          <i class="header-icon lnr-rocket icon-gradient bg-tempting-azure"></i>
          Pie Chart (Sales/Order)
        </div>
        <ul class="nav">
          <li class="nav-item">
            <a href="javascript:void(0);" class="active nav-link" onclick="updatecount('/admin/count-orders-by-day')">Day</a>
          </li>
          <li class="nav-item">
            <a href="javascript:void(0);" class="nav-link second-tab-toggle" onclick="updatecount('/admin/count-orders-by-month')">Month</a>
          </li>
          <li class="nav-item">
            <a href="javascript:void(0);" class="nav-link second-tab-toggle" onclick="updatecount('/admin/count-orders-by-year')">Year</a>
          </li>
        </ul>
      </div>
      <div class="tab-content">
        <div class="tab-pane fade active show" id="tab-eg-55">
          <div class="widget-chart p-3">
            <div style="height: 350px">
              <canvas id="pieChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<br>
<h4>Best-Selling Brand </h4>

             
            <div class="row">
              <% TopsellingBarnd.forEach((item,index)=>{ %>

         
              <div class="col-md-6 col-xl-4">
                <div class="card mb-3 widget-content">
                  <div class="widget-content-outer">
                    <div class="widget-content-wrapper">
                      <div class="widget-content-left">
                        <div class="widget-heading"><%-item._id-%></div>
                        <div class="widget-subheading rounded-circle"><%-index+1-%>:Highest-Revenue Brand</div>
                      </div>
                      <div class="widget-content-right">
                        <div class="widget-numbers text-success"><%-item.TotalQuantity-%></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <%      }) %>
              <!-- <div class="col-md-6 col-xl-4">
                <div class="card mb-3 widget-content">
                  <div class="widget-content-outer">
                    <div class="widget-content-wrapper">
                      <div class="widget-content-left">
                        <div class="widget-heading">Products Sold</div>
                        <div class="widget-subheading">Revenue streams</div>
                      </div>f
                      <div class="widget-content-right">
                        <div class="widget-numbers text-warning">$3M</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-xl-4">
                <div class="card mb-3 widget-content">
                  <div class="widget-content-outer">
                    <div class="widget-content-wrapper">
                      <div class="widget-content-left">
                        <div class="widget-heading">Followers</div>
                        <div class="widget-subheading">People Interested</div>
                      </div>
                      <div class="widget-content-right">
                        <div class="widget-numbers text-danger">45,9%</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div> -->
              <div class="d-xl-none d-lg-block col-md-6 col-xl-4">
                <div class="card mb-3 widget-content">
                  <div class="widget-content-outer">
                    <div class="widget-content-wrapper">
                      <div class="widget-content-left">
                        <div class="widget-heading">Income</div>
                        <div class="widget-subheading">Expected totals</div>
                      </div>
                      <div class="widget-content-right">
                        <div class="widget-numbers text-focus">$147</div>
                      </div>
                    </div>
                    <div class="widget-progress-wrapper">
                      <div
                        class="progress-bar-sm progress-bar-animated-alt progress"
                      >
                        <div
                          class="progress-bar bg-info"
                          role="progressbar"
                          aria-valuenow="54"
                          aria-valuemin="0"
                          aria-valuemax="100"
                          style="width: 54%"
                        ></div>
                      </div>
                      <div class="progress-sub-label">
                        <div class="sub-label-left">Expenses</div>
                        <div class="sub-label-right">100%</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12">
                <div class="main-card mb-3 card">
                  <div class="card-header">
                  Ongoing Orders
                    <div class="btn-actions-pane-right">
                      <div role="group" class="btn-group-sm btn-group">
                        <button class="active btn btn-focus">Last Week</button>
                        <button class="btn btn-focus">All Month</button>
                      </div>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table
                      class="align-middle mb-0 table table-borderless table-striped table-hover"
                    >
                      <thead>
                          <tr>
                              <th class="text-center">#</th>
                              <th>Name</th>
                              <th class="text-center">City</th>
                              <th class="text-center">Payment Status</th>
                              <th class="text-center">Status</th>
                              <th class="text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                          <% RecentOrders.forEach((ele,index)=>{ %>
                        <tr>
                          <td class="text-center text-muted"><%-index-%></td>
                          <td>
                            <div class="widget-content p-0">
                              <div class="widget-content-wrapper">
                                <div class="widget-content-left mr-3">
                                  <div class="widget-content-left">
                                    <img
                                      width="40"
                                      class="rounded-circle"
                                      src="assets/images/avatars/4.jpg"
                                      alt=""
                                    />
                                  </div>
                                </div>
                                <div class="widget-content-left flex2">
                                  <div class="widget-heading"><%-ele.address.name-%></div>
                                  <div class="widget-subheading opacity-7">
                                   UserName
                                  </div>
                                </div>
                              </div>
                            </div>
                          </td>
                          <td class="text-center"><%-ele.address.city-%></td>
                          <% if(ele.payementStatus=='Paid'){%>
                          <td class="text-center"><div class="badge badge-success"><%-ele.payementStatus-%></div></td>
                          <%}else{%>
                          <td class="text-center"><div class="badge badge-warning"><%-ele.payementStatus-%></div></td>
                          <%}%>
                         <% if(ele.orderStatus=='Order Delivered'){ %>
                          <td class="text-center">
                            <div class="badge badge-success"><%-ele.orderStatus-%></div>
                          </td>
                          <%}else{%>
                          <td class="text-center">
                            <div class="badge badge-warning"><%-ele.orderStatus-%></div>
                          </td>
                          <%}%>
                          <td class="text-center">
                           <a href="/Admin/OrderDetails/<%-ele._id-%>"> <button
                              type="button"
                              id="PopoverCustomT-1"
                              class="btn btn-primary btn-sm"
                            >
                              Details
                            </button></a>
                          </td>
                        </tr>
                        <% } ) %>
                       
                      </tbody>
                    </table>
                  </div>
                  <div class="d-block text-center card-footer">
                    <button
                      class="mr-2 btn-icon btn-icon-only btn btn-outline-danger"
                    >
                      <i class="pe-7s-trash btn-icon-wrapper"> </i>
                    </button>
                    <button class="btn-wide btn btn-success">Save</button>
                  </div>
                </div>
              </div>
            </div>
            <br>
            <h4>Best-Selling Products </h4>
            
              <div class="row">
              <div class="col-md-12">
                <div class="main-card mb-3 card">
                  <div class="card-header">
                     Highest-Rated Products
                    <div class="btn-actions-pane-right">
                      <div role="group" class="btn-group-sm btn-group">
                        <button class="active btn btn-focus">Last Week</button>
                        <button class="btn btn-focus">All Month</button>
                      </div>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table
                      class="align-middle mb-0 table table-borderless table-striped table-hover"
                    >
                      <thead>
                          <tr>
                              <th class="text-center">#</th>
                              <th>Preview</th>
                              <th class="text-center">Product</th>
                              <th class="text-center"> Price</th>
                              <th class="text-center">	Sold	</th>
                              <th class="text-center">Approx. Revenue</th>
                            </tr>
                        </thead>
                        <tbody>
                          <% Topselling.forEach((ele,index)=>{ %>
                        <tr>
                          <td class="text-center text-muted"><%-index-%></td>
                          <td>
                            <div class="widget-content p-0">
                              <div class="widget-content-wrapper">
                                <div class="widget-content-left mr-3">
                                  <div class="widget-content-left">
                                    <img
                                      width="40"
                                      class="rounded-circle"
                                      src=""
                                      alt=""
                                    />
                                  </div>
                                </div>
                                <div class="widget-content-left flex2">
                                  <div class="widget-heading ">
                                    <img src="/productimages/<%-ele?.productDetail?.images[0] -%>" alt="" style="width: 50px;">
                                  </div>
                                  <!-- <div class="widget-subheading opacity-7">
                                   UserId
                                  </div> -->
                                </div>
                              </div>
                            </div>
                          </td>
                          <td class="text-center"><%-ele?.productDetail.productName-%></td>
                          <td class="text-center">
                            <div class="badge badge-warning"><%-ele?.productDetail.Price-%></div>
                          </td>
                          <td class="text-center"><%-ele?.TotalQuantity-%></td>
                          <td class="text-center">
                            <%-ele.productDetail.DiscountAmount * ele?.TotalQuantity -%>
                            
                          </td>
                        </tr>
                        <% } ) %>
                       
                      </tbody>
                    </table>
                  </div>
                  <div class="d-block text-center card-footer">
                    <button
                      class="mr-2 btn-icon btn-icon-only btn btn-outline-danger"
                    >
                      <i class="pe-7s-trash btn-icon-wrapper"> </i>
                    </button>
                    <button class="btn-wide btn btn-success">Save</button>
                  </div>
                </div>
              </div>
            </div>
            <br>
            <!-- this -->
                  <h4>Top-Performing Category </h4>

            <div class="row">
              <% result.forEach(ele=>{ %>
              <div class="col-md-6 col-lg-3">
                <div
                  class="card-shadow-danger mb-3 widget-chart widget-chart2 text-left card"
                >
                  <div class="widget-content">
                    <div class="widget-content-outer">
                      <div class="widget-content-wrapper">
                        <div class="widget-content-left pr-2 fsize-1">
                          <div class="widget-numbers mt-0 fsize-3 text-danger">
                          <%-ele.totalQuantity-%>%
                          </div>
                        </div>
                        <div class="widget-content-right w-100">
                          <div class="progress-bar-xs progress">
                            <div
                              class="progress-bar bg-danger"
                              role="progressbar"
                              aria-valuenow="<%-ele.totalQuantity-%>"
                              aria-valuemin="0"
                              aria-valuemax="100"
                           
                              id="progressBar<%- ele._id %>"
                            ></div>
                          </div>
                        </div>
                      </div>
                      <div class="widget-content-left fsize-1">
                        <div class="text " style="color: #95109e;"><%-ele.categoryName-%></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <% }) %>
              <!-- <div class="col-md-6 col-lg-3">
                <div
                  class="card-shadow-success mb-3 widget-chart widget-chart2 text-left card"
                >
                  <div class="widget-content">
                    <div class="widget-content-outer">
                      <div class="widget-content-wrapper">
                        <div class="widget-content-left pr-2 fsize-1">
                          <div class="widget-numbers mt-0 fsize-3 text-success">
                            54%
                          </div>
                        </div>
                        <div class="widget-content-right w-100">
                          <div class="progress-bar-xs progress">
                            <div
                              class="progress-bar bg-success"
                              role="progressbar"
                              aria-valuenow="54"
                              aria-valuemin="0"
                              aria-valuemax="100"
                              style="width: 54%"
                            ></div>
                          </div>
                        </div>
                      </div>
                      <div class="widget-content-left fsize-1">
                        <div class="text-muted opacity-6">Expenses Target</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div> -->
              <!-- <div class="col-md-6 col-lg-3">
                <div
                  class="card-shadow-warning mb-3 widget-chart widget-chart2 text-left card"
                >
                  <div class="widget-content">
                    <div class="widget-content-outer">
                      <div class="widget-content-wrapper">
                        <div class="widget-content-left pr-2 fsize-1">
                          <div class="widget-numbers mt-0 fsize-3 text-warning">
                            32%
                          </div>
                        </div>
                        <div class="widget-content-right w-100">
                          <div class="progress-bar-xs progress">
                            <div
                              class="progress-bar bg-warning"
                              role="progressbar"
                              aria-valuenow="32"
                              aria-valuemin="0"
                              aria-valuemax="100"
                              style="width: 32%"
                            ></div>
                          </div>
                        </div>
                      </div>
                      <div class="widget-content-left fsize-1">
                        <div class="text-muted opacity-6">Spendings Target</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div> -->
              <!-- <div class="col-md-6 col-lg-3">
                <div
                  class="card-shadow-info mb-3 widget-chart widget-chart2 text-left card"
                >
                  <div class="widget-content">
                    <div class="widget-content-outer">
                      <div class="widget-content-wrapper">
                        <div class="widget-content-left pr-2 fsize-1">
                          <div class="widget-numbers mt-0 fsize-3 text-info">
                            59%
                          </div>
                        </div>
                        <div class="widget-content-right w-100">
                          <div class="progress-bar-xs progress">
                            <div
                              class="progress-bar bg-info"
                              role="progressbar"
                              aria-valuenow="59"
                              aria-valuemin="0"
                              aria-valuemax="100"
                              style="width: 59%"
                            ></div>
                          </div>
                        </div>
                      </div>
                      <div class="widget-content-left fsize-1">
                        <div class="text-muted opacity-6">Totals Target</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div> -->
            </div>
            <br>
            
          </div>
        </div>
     
      
    </div>
    <script
      type="text/javascript"
      src="https://demo.dashboardpack.com/architectui-html-free/assets/scripts/main.js"
    ></script>
   <script>
  document.addEventListener("DOMContentLoaded", function() {
    updatecount('/admin/count-orders-by-day');
  });

    // // Check if there is a success message
    //             const sussMsg = "<%-locals.sussMsg-%>";

    //             if (sussMsg) {
    //                 // Display an alert with the success message
    //                 alert(sussMsg);
    //             }
</script>
<!-- // Set the width of the progress bars dynamically -->
<% result.forEach(ele => { %>
  <script>
    document.getElementById("progressBar<%- ele._id %>").style.width = "<%- ele.totalQuantity %>%";
  </script>
<% }) %>


    
    <script>
      document.addEventListener("DOMContentLoaded", function(event) {
        
        const showNavbar = (toggleId, navId, bodyId, headerId) =>{
          const toggle = document.getElementById(toggleId),
          nav = document.getElementById(navId),
          bodypd = document.getElementById(bodyId),
          headerpd = document.getElementById(headerId)
          
          // Validate that all variables exist
          if(toggle && nav && bodypd && headerpd){
            toggle.addEventListener('click', ()=>{
              // show navbar
              nav.classList.toggle('show1')
              // change icon
              toggle.classList.toggle('bx-x')
              // add padding to body
              bodypd.classList.toggle('body-pd')
              // add padding to header
              headerpd.classList.toggle('body-pd')
            })
          }
         }
         
         showNavbar('header-toggle','nav-bar','body-pd','header')
         
         /*===== LINK ACTIVE =====*/
         const linkColor = document.querySelectorAll('.nav_link')
         
         function colorLink(){
           if(linkColor){
         linkColor.forEach(l=> l.classList.remove('active'))
         this.classList.add('active')
        }
      }
      
      linkColor.forEach(l=> l.addEventListener('click', colorLink))
      
      
      //Validation for Sales report 

    
    });
    function Formvalid() {
  const StartDate = document.getElementById('StartDate').value;
  const EndDate = document.getElementById('EndDate').value;
  const DownloadReport = document.getElementById('downloadFormat').value; 
  const StartDateError = document.getElementById('StartError');
  const EndDateError = document.getElementById('EndError');
  const DownloadError = document.getElementById('DownloadFormatError'); 
  const SubmitButton = document.getElementById('Downnload');

  //  error messages
  StartDateError.innerHTML = '';
  EndDateError.innerHTML = '';
  DownloadError.innerHTML = '';

  // Current date
  const currentDate = new Date().toISOString().split('T')[0];

  // Check Start Date
  if (StartDate === '') {
    StartDateError.innerHTML = 'Start Date is required';
  } else if (StartDate > currentDate) {
    StartDateError.innerHTML = 'Start Date must be less than or equal to the current date';
  }

  // Check End Date
  if (EndDate === '') {
    EndDateError.innerHTML = 'End Date is required';
  } else if (EndDate > currentDate) {
    EndDateError.innerHTML = 'End Date must be less than or equal to the current date';
  } else if (EndDate < StartDate) {
    EndDateError.innerHTML = 'End Date cannot be less than Start Date';
  }

  // Check Download Format
  if (DownloadReport === '') {
    DownloadError.innerHTML = 'Download Format is required';
  }

  // Enable or disable the Submit button
  console.log(StartDateError.innerHTML,"thishishish",EndDateError.innerHTML,"enddate",DownloadError.innerHTML,"download");
  if(!StartDateError.innerHTML && !EndDateError.innerHTML&& !DownloadError.innerHTML){
     SubmitButton.disabled = false
  }else{
     SubmitButton.disabled = true
  }
}

    </script>
          
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
          
          <script src="/vendor/apexcharts/apexcharts.min.js"></script>
          <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
          <!-- <script src="/vendor/chart.js/chart.umd.js"></script> -->
  <script src="/vendor/echarts/echarts.min.js"></script>
  <script src="/vendor/quill/quill.min.js"></script>
  <script src="/vendor/simple-datatables/simple-datatables.js"></script>
  <script src="/vendor/tinymce/tinymce.min.js"></script>
  <script src="/vendor/php-email-form/validate.js"></script>
  </body>
</html>
   

