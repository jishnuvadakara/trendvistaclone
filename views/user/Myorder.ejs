<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>U-Order</title>
  </head>
  <body>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/5.3.45/css/materialdesignicons.css"
      integrity="sha256-NAxhqDvtY0l4xn+YVa6WjAcmd94NNfttjNsDmNatFVc="
      crossorigin="anonymous"
    />
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
      integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- Include Toastify CSS and JS files -->
    <style>
      body {
        margin-top: 20px;
        background-color: #f1f3f7;
      }

      .avatar-lg {
        height: 5rem;
        width: 5rem;
      }

      .font-size-18 {
        font-size: 18px !important;
      }

      .text-truncate {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      a {
        text-decoration: none !important;
      }

      .w-xl {
        min-width: 160px;
      }

      .card {
        margin-bottom: 24px;
        -webkit-box-shadow: 0 2px 3px #e4e8f0;
        box-shadow: 0 2px 3px #e4e8f0;
      }

      .card {
        position: relative;
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-orient: vertical;
        -webkit-box-direction: normal;
        -ms-flex-direction: column;
        flex-direction: column;
        min-width: 0;
        word-wrap: break-word;
        background-color: #fff;
        background-clip: border-box;
        border: 1px solid #eff0f2;
        border-radius: 1rem;
      }
    </style>
    <body>

<%- include('../partials/usernave.ejs') %>

<% if(Myorder.length===0) { %>
  <section >
    <div class="container-fluid  mt-100">
      <div class="row">
        
        <div class="col-md-12">
          
          <div class="card gradient-custom">
            <div class="card-header">
              <h5>Order</h5>
            </div>
            <div class="card-body cart">
              <div class="col-sm-12 empty-cart-cls text-center">
                <img src="https://i.imgur.com/dCdflKN.png" width="130" height="130" class="img-fluid mb-4 mr-3">
                <h3><strong>Your Order  is Empty</strong></h3>
                <h4>Add something to make me happy :)</h4>
                <% if(locals.user){ %>
                  <a href="/allprodcuts" class="btn btn-primary cart-btn-transform m-3" data-abc="true">continue shopping</a>
                  <%}else{ %>
                    <a href="/login" class="btn btn-warning cart-btn-transform m-3" data-abc="true">Login</a>
                    <% } %>
                    
                  </div>
                </div>
              </div>
              
              
            </div>
            
          </div>
          
        </div>
      </section>
      <% }else {%>
        <div style="margin-left: 222px; margin-top: 80px">
    <% Myorder.forEach(data => { %>
    <h4>Order</h4>

    <div class="container">
        <div class="row">
            <div class="col-xl-8">
                <div class="card border shadow-none">
                    <div class="card-body">
                        <% data.products.forEach(ele => { %>
                        <div class="d-flex align-items-start border-bottom pb-3">
                            <div class="me-4">
                                <img src="/productimages/<%- ele.productId?.images[0] %>" alt="" class="avatar-lg rounded">
                            </div>
                            <div class="flex-grow-1 align-self-center overflow-hidden">
                                <div>
                                    <h5 class="text-truncate font-size-18">
                                        <a href="#" class="text-dark"><%- ele.productId?.productName %></a>
                                    </h5>
                                    <div style="display: flex; justify-content: space-between;">
                                        <p class="text-muted mb-0">
                                            <i class="bx bxs-star text-warning"></i>
                                            <i class="bx bxs-star text-warning"></i>
                                            <i class="bx bxs-star text-warning"></i>
                                            <i class="bx bxs-star text-warning"></i>
                                            <i class="bx bxs-star-half text-warning"></i>
                                        </p>
                                        <% if (ele.status == "Cancelled" || ele.status == "Return Requested") { %>
                                        <h6 class="badge rounded-pill bg-danger"><%- ele.status %></h6>
                                        <% } %>
                                    </div>
                                    <p class="mb-0 mt-1">
                                        Brand : <span class="fw-medium"><%- ele.productId?.BrandName %></span>
                                    </p>
                                </div>
                            </div>
                            <div class="flex-shrink-0 ms-2">
                                <ul class="list-inline mb-0 font-size-16">
                                    <li class="list-inline-item">
                                        <a href="#" class="text-muted px-1">Quantity: <%- ele.quantity %></a>
                                    </li>
                                    <li class="list-inline-item">
                                        <a href=""></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <% }) %>

                        <div class="row">
                            <div style="display: flex; justify-content: end">
                                <a href="/Myorderdetail/<%- data._id %>" class="btn btn-primary cart-btn-transform m-3" data-abc="true">View Details</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <% }) %>

    <!-- Pagination -->
    <div class="container mt-4">
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
                <% if (hasPrevPage) { %>
                <li class="page-item">
                    <a class="page-link" href="?page=<%= prevPage %>" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                <% } %>
                <% for (let i = 1; i <= lastPage; i++) { %>
                <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                    <a class="page-link" href="?page=<%= i %>"><%= i %></a>
                </li>
                <% } %>
                <% if (hasNextPage) { %>
                <li class="page-item">
                    <a class="page-link" href="?page=<%= nextPage %>" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
                <% } %>
            </ul>
        </nav>
    </div>
  </div>
  <% } %>


<!-- Add your scripts here -->
</body>
</html>